---
import { Image } from 'astro:assets';

interface Props {
    description: string;
    position?: 'left' | 'right' | 'content';
    image: typeof Image;
}

const { description, position = 'content', image } = Astro.props;

// Calculate width and alignment classes based on position.
const containerClasses = {
    left: 'float-left w-1/3 mr-8 mb-4 select-none',
    right: 'float-right w-1/3 ml-8 mb-4 select-none',
    center: 'mx-auto w-1/3 mb-4 select-none',
    content: 'w-full mb-8 select-none',
    default: 'w-full mb-8 select-none'
};

// Calculate width and alignment classes based on position.
const imageClasses = {
    left: 'aspect-square w-full rounded-md border border-code-stroke bg-code-bg dark:border-code-stroke-dark dark:bg-code-bg-dark',
    right: 'aspect-square w-full rounded-md border border-code-stroke bg-code-bg dark:border-code-stroke-dark dark:bg-code-bg-dark',
    center: 'aspect-square w-full rounded-md border border-code-stroke bg-code-bg dark:border-code-stroke-dark dark:bg-code-bg-dark',
    content:
        'aspect-auto w-full rounded-md border border-code-stroke bg-code-bg dark:border-code-stroke-dark dark:bg-code-bg-dark',
    default:
        'aspect-auto w-full rounded-md border border-code-stroke bg-code-bg dark:border-code-stroke-dark dark:bg-code-bg-dark'
};

const containerClass = containerClasses[position as keyof typeof containerClasses] || containerClasses.default;
const imageClass = imageClasses[position as keyof typeof imageClasses] || imageClasses.default;
---

{
    image ? (
        <figure class={containerClass}>
            <Image src={image} alt={description} class={imageClass} />

            <figcaption class="mt-3 text-balance text-center text-sm text-text-muted dark:text-text-muted-dark">
                {description}
            </figcaption>
        </figure>
    ) : (
        <p class="text-balance rounded-md bg-debug p-6 text-center font-medium text-background">
            Error: Image not found for illustration "{description}"
        </p>
    )
}

<style>
    figure:after {
        display: table;
        clear: both;
        content: '';
    }
</style>
